---
import placeholders from '../data/placeholders.json';

type PlaceholderDef = {
  type: string;
  default: string;
  description: string;
  options?: string[];
};

const groups = [
  {
    label: 'Data Center & Scrubbing Centers',
    keys: ['DC_NAME', 'CENTER_1', 'CENTER_2'],
  },
  {
    label: 'Protected Prefixes',
    keys: ['PROTECTED_CIDR_V4', 'PROTECTED_NET_V4', 'PROTECTED_PREFIX_V6', 'PROTECTED_NET_V6'],
  },
  {
    label: 'BGP',
    keys: ['CUSTOMER_ASN', 'F5_XC_ASN', 'BGP_PASSWORD'],
  },
  {
    label: 'XC Scrubbing Center Outer IPs',
    keys: ['XC_C1_OUTER_V4', 'XC_C2_OUTER_V4', 'XC_C1_OUTER_V6', 'XC_C2_OUTER_V6'],
  },
  {
    label: 'BIG-IP Outer Self IPs',
    keys: ['BIGIP_A_OUTER_V4', 'BIGIP_B_OUTER_V4', 'BIGIP_A_OUTER_V6', 'BIGIP_B_OUTER_V6'],
  },
  {
    label: 'Inner IPs — XC Side',
    keys: [
      'XC_C1_T1_INNER_V4', 'XC_C2_T1_INNER_V4', 'XC_C1_T2_INNER_V4', 'XC_C2_T2_INNER_V4',
      'XC_C1_T1_INNER_V6', 'XC_C2_T1_INNER_V6', 'XC_C1_T2_INNER_V6', 'XC_C2_T2_INNER_V6',
    ],
  },
  {
    label: 'Inner IPs — BIG-IP Side',
    keys: [
      'BIGIP_C1_T1_INNER_V4', 'BIGIP_C2_T1_INNER_V4', 'BIGIP_C1_T2_INNER_V4', 'BIGIP_C2_T2_INNER_V4',
      'BIGIP_C1_T1_INNER_V6', 'BIGIP_C2_T1_INNER_V6', 'BIGIP_C1_T2_INNER_V6', 'BIGIP_C2_T2_INNER_V6',
    ],
  },
];

const defs = placeholders as Record<string, PlaceholderDef>;
---

<details class="ph-form-wrapper">
  <summary>Customize values for this guide</summary>
  <form id="placeholder-form">
    {groups.map((group) => (
      <fieldset>
        <legend>{group.label}</legend>
        <div class="ph-grid">
          {group.keys.map((key) => {
            const def = defs[key];
            if (!def) return null;
            return (
              <label>
                <span class="ph-label">{def.description}</span>
                {def.type === 'dropdown' && def.options ? (
                  <select name={key}>
                    {def.options.map((opt: string) => (
                      <option value={opt} selected={opt === def.default}>
                        {opt}
                      </option>
                    ))}
                  </select>
                ) : (
                  <input type="text" name={key} value={def.default} />
                )}
              </label>
            );
          })}
        </div>
      </fieldset>
    ))}
  </form>
</details>

<script>
  import '../scripts/placeholder.ts';
</script>

<style>
  .ph-form-wrapper {
    margin-block: 1rem;
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.5rem;
    padding: 0.75rem;
    background: var(--sl-color-gray-7);
  }
  .ph-form-wrapper summary {
    cursor: pointer;
    font-weight: 600;
    color: var(--sl-color-white);
  }
  .ph-form-wrapper[open] summary {
    margin-bottom: 0.75rem;
  }
  fieldset {
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.375rem;
    padding: 0.75rem;
    margin-bottom: 0.75rem;
  }
  legend {
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--sl-color-text-accent);
    padding: 0 0.25rem;
  }
  .ph-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 0.5rem;
  }
  label {
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
  }
  .ph-label {
    font-size: 0.75rem;
    color: var(--sl-color-gray-2);
  }
  input, select {
    padding: 0.35rem 0.5rem;
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.25rem;
    background: var(--sl-color-gray-6);
    color: var(--sl-color-white);
    font-family: var(--sl-font-mono);
    font-size: 0.85rem;
  }
  input:focus, select:focus {
    outline: 2px solid var(--sl-color-text-accent);
    outline-offset: -1px;
  }
</style>
